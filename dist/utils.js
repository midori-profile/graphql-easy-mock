!function(){"use strict";const e="GRAPHQL_MOCK_ALERT",t={pluginSwitchOn:!1,pluginMockResponseList:[{name:"",value:"",disabled:!1}],utils:{mockResponse:!0,openCompInEditor:!0}},s={blockResourceRules:[],entrypoints:[],staticResourceRules:[],ajaxRules:[]};var n,o;!function(e){e.GraphQL="graphql",e.RESTFUL="RESTful"}(n||(n={})),function(e){e.GET="GET",e.POST="POST",e.DELETE="DELETE",e.PUT="PUT"}(o||(o={}));const i=e=>!e.disabled&&e.name&&e.value,a=function(){let e={ajaxRules:[],staticResourceRules:[]};const t=window.fetch,s=XMLHttpRequest.prototype.open,o=XMLHttpRequest.prototype.send,i=XMLHttpRequest.prototype.setRequestHeader,a=async function(...s){var n,o,i;const[a,r]=s[0]instanceof Request?[s[0].url,s[0]]:s,l="string"==typeof a&&e.ajaxRules.find((e=>{var t,s;return e.filter({method:null!==(t=null==r?void 0:r.method)&&void 0!==t?t:"GET",url:a,headers:null!==(s=null==r?void 0:r.headers)&&void 0!==s?s:{},body:null==r?void 0:r.body})}));if(l){let e=a,s=r;const{modifyRequest:c,modifyResponse:d,statusCode:h}=l;if(c){const t=c({method:"GET",url:a,headers:null!==(n=null==r?void 0:r.headers)&&void 0!==n?n:{}});t.url&&(e=t.url),t.headers&&(s=Object.assign(Object.assign({},null!=s?s:{}),{headers:Object.assign(Object.assign({},null!==(o=null==s?void 0:s.headers)&&void 0!==o?o:{}),null!==(i=t.headers)&&void 0!==i?i:{})})),t.delay&&await(u=t.delay,new Promise((e=>{window.setTimeout(e,u)})))}const p=await t(e,s);return d?new Response(d(p),{status:h||200}):p}return t(...s);var u},r=function(e,t){"string"==typeof t&&(this.method=e,this.url=t),s.call(this,e,t)},l=function(e,t){var s;this.headers=null!==(s=this.headers)&&void 0!==s?s:{},this.headers[e]=t,i.call(this,e,t)},u=function(t){var s,a;const r=this.url&&e.ajaxRules.find((e=>e.filter({method:this.method,url:this.url,headers:this.headers,body:t})));if(r){const e=r.type===n.GraphQL,{modifyRequest:t,modifyResponse:o,statusCode:l}=r;if(t){const e=t({method:this.method,url:this.url,headers:this.headers});if(e.url&&(this.url=e.url,this.open(this.method,this.url)),e.headers)for(const t in e.headers)this.setRequestHeader(t,e.headers[t]);else e.url&&Object.keys(null!==(s=this.headers)&&void 0!==s?s:{}).forEach((e=>{i.call(this,e,this.headers[e])}));this.delay=null!==(a=e.delay)&&void 0!==a?a:0}o&&this.addEventListener("readystatechange",(function(){const t=this.getResponseHeader("Content-Type");if(4===this.readyState&&t.startsWith("application/json"))try{let t={};try{t=JSON.parse(this.responseText)}catch(e){t=this.response}Object.defineProperty(this,"responseText",{value:o(t),writable:!0}),Object.defineProperty(this,"response",{value:e?o(t):JSON.parse(o(t)),writable:!0}),Object.defineProperty(this,"status",{value:l||200,writable:!0})}catch(e){console.log(e)}}))}o.call(this,t)};return function(n){e=n,window.fetch=e.ajaxRules.length?a:t,XMLHttpRequest.prototype.open=e.ajaxRules.length?r:s,XMLHttpRequest.prototype.send=e.ajaxRules.length?u:o,XMLHttpRequest.prototype.setRequestHeader=e.ajaxRules.length?l:i}},r=(e,t)=>({method:s,url:i,body:a})=>{const r=(i||"").split("?")[0];let l={};if("string"==typeof a)try{l=JSON.parse(a)}catch(e){l={}}return t.type===n.GraphQL?r.endsWith(e)&&l.operationName===t.operationName:r.endsWith(e)&&s===(t.method||o.GET)},l=e=>()=>{try{return e.responseText}catch(e){return""}},u=e=>{const{name:t,value:s}=e,n=(e=>{try{return JSON.parse(e)}catch(e){return null}})(s);return n?{filter:r(t,n),modifyResponse:l(n),type:n.type,statusCode:Number(n.statusCode||"200")}:null};(async s=>{let n=!0;const o=a(),r=!!document.getElementById("graphql-script-id");r&&n&&(window.graphQLPlugin={},window.postMessage({key:"PAGE_READY_KEY",value:!0},"*"));const l=async e=>{var o;const a=(e=>{var s,n;return Object.assign(Object.assign(Object.assign({},t),e),{pluginSwitchOn:!!e.pluginSwitchOn&&(n=null!==(s=e.lastEffectiveTimestamp)&&void 0!==s?s:Date.now(),(Date.now()-n)/36e5<12)})})(null!==(o=e.value)&&void 0!==o?o:{}),{entrypoints:r=[],blockResourceRules:l=[],ajaxRules:c=[],staticResourceRules:d=[],mainFrameText:h}=await s(a,n);return c.unshift(...(e=>e.pluginSwitchOn?(e.pluginMockResponseList||[]).filter(i).map(u).filter(Boolean):[])(a)),{entrypoints:r,blockResourceRules:l,ajaxRules:c,staticResourceRules:d,mainFrameText:h}};window.addEventListener("message",(async t=>{const{data:s}=t;if("GRAPHQL_MOCK_SETTING"===(null==s?void 0:s.key))try{const{entrypoints:t,blockResourceRules:i,ajaxRules:a,staticResourceRules:u,mainFrameText:c}=await l(s),d=t.length>0||i.length>0||a.length>0||u.length>0;(t=>{t&&!window.sessionStorage.getItem(e)&&(window.sessionStorage.setItem(e,"true"),n&&console.log("ðŸš€ Graphql Easy Mock is running in your website for the first time!"))})(d),((e,t)=>{var s,o;n&&(!r&&(null===(o=null===(s=window.graphQLPlugin)||void 0===s?void 0:s.blockObserver)||void 0===o||o.disconnect()),t&&document.write(t),e&&(document.title=`${document.title} (GraphQL Easy Mock)`),n=!1)})(d,c),o({ajaxRules:a,staticResourceRules:u})}catch(e){console.log(e)}}))})((async()=>Object.assign({},s)))}();
